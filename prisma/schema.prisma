generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model ca_lam_viec {
  ma_nv         String    @db.VarChar(10)
  ca_lam_viec   String    @db.VarChar(100)
  ngay_lam      DateTime  @db.Date
  thoi_gian_lam Int?      @default(8)
  nhan_vien     nhan_vien @relation(fields: [ma_nv], references: [ma_nv], onDelete: NoAction, onUpdate: NoAction, map: "ca_lam_viec_ibfk_1")

  @@id([ma_nv, ca_lam_viec])
}

model ca_nhan {
  cccd           String         @id @db.VarChar(15)
  ten            String?        @db.VarChar(50)
  email          String?        @db.VarChar(50)
  sdt            String?        @db.VarChar(10)
  don_vi_to_chuc don_vi_to_chuc @relation(fields: [cccd], references: [ma_so_rieng], onDelete: NoAction, onUpdate: NoAction, map: "ca_nhan_ibfk_1")
}

model cap_do {
  cap                  Int                    @id @default(autoincrement())
  so_diem_can          Int?
  ten_cap_do           String?                @db.VarChar(20)
  tai_khoan_khach_hang tai_khoan_khach_hang[]
}

model dien_vien {
  ma_phim   String @db.VarChar(10)
  dien_vien String @db.VarChar(50)
  phim      phim   @relation(fields: [ma_phim], references: [ma_phim], onDelete: NoAction, onUpdate: NoAction, map: "dien_vien_ibfk_1")

  @@id([ma_phim, dien_vien])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model do_an_thuc_uong {
  ma_sp                           String                            @id @db.VarChar(10)
  ten                             String?                           @db.VarChar(100)
  kich_co                         Int?
  gia_tien                        Int?
  ma_nhan_vien_phuc_vu            String                            @db.VarChar(10)
  ma_khach_hang                   String?                           @db.VarChar(10)
  nhan_vien_ban_hang              nhan_vien_ban_hang                @relation(fields: [ma_nhan_vien_phuc_vu], references: [ma_nv], onDelete: NoAction, onUpdate: NoAction, map: "do_an_thuc_uong_ibfk_1")
  khach_hang                      khach_hang?                       @relation(fields: [ma_khach_hang], references: [ma_khach_hang], onDelete: NoAction, onUpdate: NoAction, map: "do_an_thuc_uong_ibfk_2")
  hoa_don_bao_gom_do_an_thuc_uong hoa_don_bao_gom_do_an_thuc_uong[]

  @@index([ma_khach_hang], map: "ma_khach_hang")
  @@index([ma_nhan_vien_phuc_vu], map: "ma_nhan_vien_phuc_vu")
}

model don_vi_to_chuc {
  ma_so_rieng     String            @id @db.VarChar(10)
  ca_nhan         ca_nhan?
  to_chuc         to_chuc?
  to_chuc_su_kien to_chuc_su_kien[]
}

model ghe {
  ma_rap           String           @db.VarChar(10)
  ma_phong         String           @db.VarChar(10)
  ma_ghe           String           @db.VarChar(3)
  loai_ghe         String           @db.VarChar(10)
  phong_chieu_phim phong_chieu_phim @relation(fields: [ma_rap, ma_phong], references: [ma_rap, ma_phong], onDelete: NoAction, onUpdate: NoAction, map: "ghe_ibfk_1")
  ve               ve[]

  @@id([ma_rap, ma_phong, ma_ghe])
}

model hoa_don {
  ma_hoa_don                      String                            @id @db.VarChar(10)
  trang_thai_thanh_toan           Boolean
  thoi_gian                       DateTime?                         @db.DateTime(0)
  phuong_thuc_thanh_toan          String?                           @db.VarChar(20)
  ma_nhan_vien_phu_trach          String?                           @db.VarChar(10)
  ma_khach_hang                   String?                           @db.VarChar(10)
  ma_km                           String?                           @db.VarChar(10)
  tong_tien                       Int?
  nhan_vien_ban_hang              nhan_vien_ban_hang?               @relation(fields: [ma_nhan_vien_phu_trach], references: [ma_nv], onDelete: NoAction, onUpdate: NoAction, map: "hoa_don_ibfk_1")
  khach_hang                      khach_hang?                       @relation(fields: [ma_khach_hang], references: [ma_khach_hang], onDelete: NoAction, onUpdate: NoAction, map: "hoa_don_ibfk_2")
  khuyen_mai                      khuyen_mai?                       @relation(fields: [ma_km], references: [ma_km], onDelete: NoAction, onUpdate: NoAction, map: "hoa_don_ibfk_3")
  hoa_don_bao_gom_do_an_thuc_uong hoa_don_bao_gom_do_an_thuc_uong[]
  ve                              ve[]

  @@index([ma_khach_hang], map: "ma_khach_hang")
  @@index([ma_km], map: "ma_km")
  @@index([ma_nhan_vien_phu_trach], map: "ma_nhan_vien_phu_trach")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model hoa_don_bao_gom_do_an_thuc_uong {
  ma_hoa_don         String          @db.VarChar(10)
  ma_do_an_thuc_uong String          @db.VarChar(10)
  so_luong           Int?
  hoa_don            hoa_don         @relation(fields: [ma_hoa_don], references: [ma_hoa_don], onDelete: NoAction, onUpdate: NoAction, map: "hoa_don_bao_gom_do_an_thuc_uong_ibfk_1")
  do_an_thuc_uong    do_an_thuc_uong @relation(fields: [ma_do_an_thuc_uong], references: [ma_sp], onDelete: NoAction, onUpdate: NoAction, map: "hoa_don_bao_gom_do_an_thuc_uong_ibfk_2")

  @@id([ma_hoa_don, ma_do_an_thuc_uong])
  @@index([ma_do_an_thuc_uong], map: "ma_do_an_thuc_uong")
}

model khach_hang {
  ma_khach_hang        String                 @id @db.VarChar(10)
  ten                  String?                @db.VarChar(50)
  sdt                  String?                @db.VarChar(10)
  gioi_tinh            String?                @db.VarChar(3)
  email                String?                @db.VarChar(100)
  do_an_thuc_uong      do_an_thuc_uong[]
  hoa_don              hoa_don[]
  tai_khoan_khach_hang tai_khoan_khach_hang[]
  ve                   ve[]
}

model khuyen_mai {
  ma_km               String               @id @db.VarChar(10)
  ten_km              String?              @db.VarChar(50)
  loai_km             String?              @db.VarChar(50)
  thoi_gian_bat_dau   DateTime             @db.Date
  thoi_gian_ket_thuc  DateTime             @db.Date
  gia_tri             Int?
  ma_nv_quan_ly       String?              @db.VarChar(10)
  hoa_don             hoa_don[]
  quan_tri_vien       quan_tri_vien?       @relation(fields: [ma_nv_quan_ly], references: [ma_nv], onDelete: NoAction, onUpdate: NoAction, map: "khuyen_mai_ibfk_1")
  khuyen_mai_quy_doi  khuyen_mai_quy_doi?
  khuyen_mai_toan_rap khuyen_mai_toan_rap?

  @@index([ma_nv_quan_ly], map: "ma_nv_quan_ly")
}

model khuyen_mai_quy_doi {
  ma_km              String               @id @db.VarChar(10)
  khuyen_mai         khuyen_mai           @relation(fields: [ma_km], references: [ma_km], onDelete: NoAction, onUpdate: NoAction, map: "khuyen_mai_quy_doi_ibfk_1")
  quy_doi_khuyen_mai quy_doi_khuyen_mai[]
}

model khuyen_mai_toan_rap {
  ma_km                       String                        @id @db.VarChar(10)
  khuyen_mai                  khuyen_mai                    @relation(fields: [ma_km], references: [ma_km], onDelete: NoAction, onUpdate: NoAction, map: "khuyen_mai_toan_rap_ibfk_1")
  rap_phim_ap_dung_khuyen_mai rap_phim_ap_dung_khuyen_mai[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model nhan_vien {
  ma_nv                                                String              @id @db.VarChar(10)
  ten                                                  String?             @db.VarChar(50)
  cccd                                                 String              @db.VarChar(15)
  sdt                                                  String?             @db.VarChar(10)
  ngay_sinh                                            DateTime?           @db.Date
  gioi_tinh                                            String?             @db.VarChar(3)
  luong                                                Int?
  chuc_vu                                              String?             @db.VarChar(50)
  dia_chi                                              String?             @db.VarChar(100)
  ma_nv_quan_ly                                        String?             @db.VarChar(10)
  ma_rap_phim                                          String              @db.VarChar(10)
  ca_lam_viec                                          ca_lam_viec[]
  quan_tri_vien_nhan_vien_ma_nv_quan_lyToquan_tri_vien quan_tri_vien?      @relation("nhan_vien_ma_nv_quan_lyToquan_tri_vien", fields: [ma_nv_quan_ly], references: [ma_nv], onDelete: NoAction, onUpdate: NoAction, map: "fk_nv_quan_ly")
  rap_phim                                             rap_phim            @relation(fields: [ma_rap_phim], references: [ma_rap], onDelete: NoAction, onUpdate: NoAction, map: "nhan_vien_ibfk_1")
  nhan_vien_ban_hang                                   nhan_vien_ban_hang?
  quan_tri_vien_quan_tri_vien_ma_nvTonhan_vien         quan_tri_vien?      @relation("quan_tri_vien_ma_nvTonhan_vien")

  @@index([ma_nv_quan_ly], map: "fk_nv_quan_ly")
  @@index([ma_rap_phim], map: "ma_rap_phim")
}

model nhan_vien_ban_hang {
  ma_nv           String            @id @db.VarChar(10)
  do_an_thuc_uong do_an_thuc_uong[]
  hoa_don         hoa_don[]
  nhan_vien       nhan_vien         @relation(fields: [ma_nv], references: [ma_nv], onDelete: NoAction, onUpdate: NoAction, map: "nhan_vien_ban_hang_ibfk_1")
  ve              ve[]
}

model phim {
  ma_phim              String       @id @db.VarChar(10)
  ten_phim             String?      @db.VarChar(100)
  thoi_luong           DateTime?    @db.Time(0)
  do_tuoi_yeu_cau      Int?
  thoi_gian_cong_chieu DateTime?    @db.Date
  tom_tat_noi_dung     String?      @db.VarChar(1000)
  dao_dien             String?      @db.VarChar(50)
  dien_vien            dien_vien[]
  suat_chieu           suat_chieu[]
  the_loai             the_loai[]
}

model phong_chieu_phim {
  ma_rap     String       @db.VarChar(10)
  ma_phong   String       @db.VarChar(10)
  so_ghe     Int?
  ghe        ghe[]
  rap_phim   rap_phim     @relation(fields: [ma_rap], references: [ma_rap], onDelete: NoAction, onUpdate: NoAction, map: "phong_chieu_phim_ibfk_1")
  suat_chieu suat_chieu[]

  @@id([ma_rap, ma_phong])
}

model quan_tri_vien {
  ma_nv                                            String       @id @db.VarChar(10)
  khuyen_mai                                       khuyen_mai[]
  nhan_vien_nhan_vien_ma_nv_quan_lyToquan_tri_vien nhan_vien[]  @relation("nhan_vien_ma_nv_quan_lyToquan_tri_vien")
  nhan_vien_quan_tri_vien_ma_nvTonhan_vien         nhan_vien    @relation("quan_tri_vien_ma_nvTonhan_vien", fields: [ma_nv], references: [ma_nv], onDelete: NoAction, onUpdate: NoAction, map: "quan_tri_vien_ibfk_1")
  suat_chieu                                       suat_chieu[]
}

model quy_doi_khuyen_mai {
  ma_km                String               @db.VarChar(10)
  ma_khach_hang        String               @db.VarChar(10)
  ten_tai_khoan        String               @db.VarChar(50)
  khuyen_mai_quy_doi   khuyen_mai_quy_doi   @relation(fields: [ma_km], references: [ma_km], onDelete: NoAction, onUpdate: NoAction, map: "quy_doi_khuyen_mai_ibfk_1")
  tai_khoan_khach_hang tai_khoan_khach_hang @relation(fields: [ten_tai_khoan, ma_khach_hang], references: [ten_tai_khoan, ma_khach_hang], onDelete: NoAction, onUpdate: NoAction, map: "quy_doi_khuyen_mai_ibfk_2")

  @@id([ma_km, ma_khach_hang, ten_tai_khoan])
  @@index([ten_tai_khoan, ma_khach_hang], map: "ten_tai_khoan")
}

model rap_phim {
  ma_rap                      String                        @id @db.VarChar(10)
  ten                         String?                       @db.VarChar(100)
  dia_chi                     String?                       @db.VarChar(255)
  sdt                         String?                       @db.VarChar(10)
  so_phong                    Int?
  nhan_vien                   nhan_vien[]
  phong_chieu_phim            phong_chieu_phim[]
  rap_phim_ap_dung_khuyen_mai rap_phim_ap_dung_khuyen_mai[]
  to_chuc_su_kien             to_chuc_su_kien[]
}

model rap_phim_ap_dung_khuyen_mai {
  ma_rap_phim         String              @db.VarChar(10)
  ma_km               String              @db.VarChar(10)
  rap_phim            rap_phim            @relation(fields: [ma_rap_phim], references: [ma_rap], onDelete: NoAction, onUpdate: NoAction, map: "rap_phim_ap_dung_khuyen_mai_ibfk_1")
  khuyen_mai_toan_rap khuyen_mai_toan_rap @relation(fields: [ma_km], references: [ma_km], onDelete: NoAction, onUpdate: NoAction, map: "rap_phim_ap_dung_khuyen_mai_ibfk_2")

  @@id([ma_rap_phim, ma_km])
  @@index([ma_km], map: "ma_km")
}

model su_kien {
  ma_sk            String            @id @db.VarChar(10)
  ten_sk           String?           @db.VarChar(50)
  quy_mo           String?           @db.VarChar(20)
  do_tuoi_gioi_han Int?
  chi_phi          Int?
  thoi_gian        DateTime?         @db.DateTime(0)
  noi_dung_su_kien String?           @db.VarChar(1000)
  to_chuc_su_kien  to_chuc_su_kien[]
}

model suat_chieu {
  ma_luot_chieu          String           @id @db.VarChar(10)
  thoi_gian_bat_dau      DateTime?        @db.DateTime(0)
  thoi_gian_ket_thuc     DateTime?        @db.DateTime(0)
  hinh_thuc_chieu        String?          @db.VarChar(10)
  ngon_ngu               String?          @db.VarChar(20)
  phu_de_hoac_long_tieng String?          @db.VarChar(10)
  ma_phim                String           @db.VarChar(10)
  ma_rap                 String           @db.VarChar(10)
  ma_phong_chieu         String           @db.VarChar(10)
  ma_nhan_vien_quan_ly   String           @db.VarChar(10)
  phim                   phim             @relation(fields: [ma_phim], references: [ma_phim], onDelete: NoAction, onUpdate: NoAction, map: "suat_chieu_ibfk_1")
  quan_tri_vien          quan_tri_vien    @relation(fields: [ma_nhan_vien_quan_ly], references: [ma_nv], onDelete: NoAction, onUpdate: NoAction, map: "suat_chieu_ibfk_2")
  phong_chieu_phim       phong_chieu_phim @relation(fields: [ma_rap, ma_phong_chieu], references: [ma_rap, ma_phong], onDelete: NoAction, onUpdate: NoAction, map: "suat_chieu_ibfk_3")
  ve                     ve[]

  @@index([ma_nhan_vien_quan_ly], map: "ma_nhan_vien_quan_ly")
  @@index([ma_phim], map: "ma_phim")
  @@index([ma_rap, ma_phong_chieu], map: "ma_rap")
}

model tai_khoan_khach_hang {
  ten_tai_khoan       String               @db.VarChar(50)
  ma_khach_hang       String               @db.VarChar(10)
  mat_khau            String?              @db.VarChar(50)
  cap                 Int?
  so_diem_tich_duoc   Int?
  so_diem_can_len_cap Int?
  quy_doi_khuyen_mai  quy_doi_khuyen_mai[]
  khach_hang          khach_hang           @relation(fields: [ma_khach_hang], references: [ma_khach_hang], onDelete: NoAction, onUpdate: NoAction, map: "tai_khoan_khach_hang_ibfk_1")
  cap_do              cap_do?              @relation(fields: [cap], references: [cap], onDelete: NoAction, onUpdate: NoAction, map: "tai_khoan_khach_hang_ibfk_2")

  @@id([ten_tai_khoan, ma_khach_hang])
  @@index([cap], map: "cap")
  @@index([ma_khach_hang], map: "ma_khach_hang")
}

model the_loai {
  ma_phim  String @db.VarChar(10)
  the_loai String @db.VarChar(100)
  phim     phim   @relation(fields: [ma_phim], references: [ma_phim], onDelete: NoAction, onUpdate: NoAction, map: "the_loai_ibfk_1")

  @@id([ma_phim, the_loai])
}

model to_chuc {
  ma_so_rieng    String         @id @db.VarChar(10)
  ten_to_chuc    String?        @db.VarChar(50)
  email          String?        @db.VarChar(50)
  sdt            String?        @db.VarChar(10)
  don_vi_to_chuc don_vi_to_chuc @relation(fields: [ma_so_rieng], references: [ma_so_rieng], onDelete: NoAction, onUpdate: NoAction, map: "to_chuc_ibfk_1")
}

model to_chuc_su_kien {
  ma_don_vi_to_chuc String         @db.VarChar(10)
  ma_su_kien        String         @db.VarChar(10)
  ma_rap_phim       String         @db.VarChar(10)
  ma_phong_phim     String         @db.VarChar(10)
  rap_phim          rap_phim       @relation(fields: [ma_rap_phim], references: [ma_rap], onDelete: NoAction, onUpdate: NoAction, map: "to_chuc_su_kien_ibfk_1")
  don_vi_to_chuc    don_vi_to_chuc @relation(fields: [ma_don_vi_to_chuc], references: [ma_so_rieng], onDelete: NoAction, onUpdate: NoAction, map: "to_chuc_su_kien_ibfk_2")
  su_kien           su_kien        @relation(fields: [ma_su_kien], references: [ma_sk], onDelete: NoAction, onUpdate: NoAction, map: "to_chuc_su_kien_ibfk_3")

  @@id([ma_rap_phim, ma_don_vi_to_chuc, ma_su_kien])
  @@index([ma_don_vi_to_chuc], map: "ma_don_vi_to_chuc")
  @@index([ma_su_kien], map: "ma_su_kien")
}

model ve {
  ma_ve                String             @id @db.VarChar(10)
  gia_ve               Int?
  ma_rap               String             @db.VarChar(10)
  ma_phong             String             @db.VarChar(10)
  ma_ghe               String             @db.VarChar(3)
  ma_luot_chieu        String             @db.VarChar(10)
  ma_hoa_don           String             @db.VarChar(10)
  ma_nhan_vien_ban_ve  String             @db.VarChar(10)
  thoi_gian_thanh_toan DateTime?          @db.DateTime(0)
  ma_khach_hang        String?            @db.VarChar(10)
  ghe                  ghe                @relation(fields: [ma_rap, ma_phong, ma_ghe], references: [ma_rap, ma_phong, ma_ghe], onDelete: NoAction, onUpdate: NoAction, map: "ve_ibfk_1")
  suat_chieu           suat_chieu         @relation(fields: [ma_luot_chieu], references: [ma_luot_chieu], onDelete: NoAction, onUpdate: NoAction, map: "ve_ibfk_2")
  nhan_vien_ban_hang   nhan_vien_ban_hang @relation(fields: [ma_nhan_vien_ban_ve], references: [ma_nv], onDelete: NoAction, onUpdate: NoAction, map: "ve_ibfk_3")
  hoa_don              hoa_don            @relation(fields: [ma_hoa_don], references: [ma_hoa_don], onDelete: NoAction, onUpdate: NoAction, map: "ve_ibfk_4")
  khach_hang           khach_hang?        @relation(fields: [ma_khach_hang], references: [ma_khach_hang], onDelete: NoAction, onUpdate: NoAction, map: "ve_ibfk_5")

  @@index([ma_hoa_don], map: "ma_hoa_don")
  @@index([ma_khach_hang], map: "ma_khach_hang")
  @@index([ma_luot_chieu], map: "ma_luot_chieu")
  @@index([ma_nhan_vien_ban_ve], map: "ma_nhan_vien_ban_ve")
  @@index([ma_rap, ma_phong, ma_ghe], map: "ma_rap")
}
